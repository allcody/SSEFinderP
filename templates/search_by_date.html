{% extends 'base.html' %}

{% block content %}

    <form name="form" action="{% url 'search_by_date' %}" method="get">
      {% if startDate %}
        <input type="date" name="startDate" value="{{ startDate }}">
      {% else %}
        <input type="date" name="startDate">
      {% endif %}

      {% if endDate %}
        <input type="date" name="endDate" value="{{ endDate }}">
      {% else %}
        <input type="date" name="endDate">
      {% endif %}

      <input type="submit" value="Search">
    </form>

    {% for event in event_list %}
    <table class="table">
      <thead>
        <tr>
          <th scope="col">No.</th>
          <th scope="col">Venue Name</th>
          <th scope="col">Venue Location</th>
          <th scope="col">Venue Address</th>
          <th scope="col">Coordinate</th>
          <th scope="col">Date</th>
          <th scope="col">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">{{ event.id }}</th>
          <td>{{ event.venue_name }}</td>
          <td>{{ event.venue_location }}</td>
          <td>{{ event.address }}</td>
          <td>{{ event.x_coordinate }}, {{ event.y_coordinate }}</td>
          <td>{{ event.date }}</td>
          <td>{{ event.description }}</td>
        </tr>
      </tbody>
    </table>

    <p>
      <a class="btn btn-primary" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
        Click For more
      </a>
    </p>
    <div class="collapse" id='collapseExample'>
      <div class="card card-body">
          <h3>Possible Infectors</h3> 
          <br>
          {% for infector_case in event.infectors %}
          
              <li>Case Number: <a href="{% url 'search_by_case'%}?caseNum={{ infector_case.pk }} ">{{ infector_case }} </a> </li>
              <li>Onset Date: {{ infector_case.onset_date }}</li>
          <br>
          {% empty %}
            No Cases Yet
          {% endfor %}

          <h3>Possible Infected</h3>
          <br>
          {% for infected_case in event.infecteds %}
              <li> Case Number: <a href="{% url 'search_by_case'%}?caseNum={{ infected_case.pk }} ">{{ infected_case }}</a></li>
              <li> Onset Date: {{ infected_case.onset_date }}</li>
          <br>
          {% empty %}
            No Cases Yet
          {% endfor %}
      </div>
    </div>

    <!-- <button type="button" class="btn btn-primary">Add Case</button> -->
    <p>
      <a class="btn btn-primary" href="{% url 'add-attendance' "event" event.pk %}">Add Attendees</a>
    </p>
    
    <!-- <script>
      var btn = document.getElementsByClassName('btn btn-primary')
      btn.id = event.id
      btn.href = "addAttendance/" + "case" + event.id
    </script> -->
    {% endfor %}

    {% if not event_list %}
<div><h2>No Potential Superspreading Event Within the Period Found!</h2></div>
    {% endif %}
{% endblock %}
